<?xml version="1.0"?>
<!DOCTYPE plugin [
  <!ENTITY process-metrics SYSTEM "/pdk/plugins/process-metrics.xml">
]>
<plugin name="tomcat-extra">
   <classpath>
      <include name="pdk/lib/mx4j" />
   </classpath>

   <server name="Apache Tomcat 6.0 Extra">

      <config>
         <option name="jmx.url" description="JMX URL to MBeanServer" default="service:jmx:rmi:///jndi/rmi://localhost:6969/jmxrmi" />
         <option name="jmx.username" description="JMX username" optional="true" default="system" />
         <option name="jmx.password" description="JMX password" optional="true" default="manager" type="secret" />
      </config>

      <property name="domain" value="Catalina" />
      <property name="PROC_HOME_PROPERTY" value="catalina.base" />
      <plugin type="autoinventory" class="org.hyperic.hq.product.jmx.MxServerDetector" />
      <plugin type="measurement" class="org.hyperic.hq.product.jmx.MxMeasurementPlugin" />

      <service name="Global DataSource Pool">
         <property name="OBJECT_NAME" value="${domain}:type=DataSource,class=*,name=*" />

         <plugin type="autoinventory" />

         <config>
            <option name="class" description="Associated Java Class" default="javax.sql.DataSource" />
            <option name="name" description="Name of Data Source" default="" />
         </config>

         <filter name="template" value="${OBJECT_NAME}:${alias}" />

         <metric name="Availability" indicator="true" />
         <metric name="Idle DataSource Connections" alias="numIdle" indicator="true" template="${OBJECT_NAME}:${alias}" units="none" />
         <metric name="Active DataSource Connections" alias="numActive" indicator="true" template="${OBJECT_NAME}:${alias}" units="none" />
      </service>

      <service name="Executor">
         <property name="OBJECT_NAME" value="${domain}:type=Executor,name=*" />

         <plugin type="autoinventory" />

         <config>
            <option name="name" description="Name of the Executor" default="" />
         </config>

         <filter name="template" value="${OBJECT_NAME}:${alias}" />

         <metric name="Availability" indicator="true" />
         <metric name="Active Count" alias="activeCount" indicator="true" template="${OBJECT_NAME}:${alias}" units="none" />
         <metric name="Core Pool Size" alias="corePoolSize" indicator="true" template="${OBJECT_NAME}:${alias}" units="none" />
         <metric name="Pool Size" alias="poolSize" indicator="true" template="${OBJECT_NAME}:${alias}" units="none" />
         <metric name="Queue Size" alias="queueSize" indicator="true" template="${OBJECT_NAME}:${alias}" units="none" />
      </service>
   </server>
</plugin>